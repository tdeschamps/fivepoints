box: wercker-labs/docker

build:
    steps:
        - script:
        
            name: upgrade docker
            code: |
              which docker
              mkdir tmp
              curl https://get.docker.com/builds/Linux/x86_64/docker-latest -o tmp/docker
              chmod +x tmp/docker
              sudo service docker stop
              sudo cp tmp/docker /usr/bin/docker
              sudo service docker start
        - script:
            name: docker version
            code: docker -v
        - script:
            name: docker build
            code: |
              docker build --rm=false -t fivemarks .

deploy:
    steps:
        - script:
            name: install ruby
            code: sudo apt-get install -y ruby
        - mrono/elastic-beanstalk-deploy:
            key: $KEY
            secret: $SECRET_KEY
            app_name: My First Elastic Beanstalk Application
            env_name: fivemarks
            region: eu-west-2