commands:
  create_post_dir:
    command: "mkdir /opt/elasticbeanstalk/hooks/appdeploy/post"
    ignoreErrors: true
files:
  "/etc/nginx/conf.d/nginx.conf":
    mode: '000644'
    content: |
      server {
        listen 80;
        client_max_body_size 50M;
        root /app/public;
        try_files $uri @unicorn_server;
        location ~ ^/(assets|images|javascripts|stylesheets|swfs|system)/ {
          gzip_static on;
          expires max;
          add_header Cache-Control public;
          add_header Last-Modified "";
          add_header ETag "";
          open_file_cache max=1000 inactive=500s;
          open_file_cache_valid 600s;
          open_file_cache_errors on;
          break;
        }
        location / {
          if ($request_method = 'GET') {
            add_header 'Access-Control-Allow-Origin' '*';
            add_header 'Access-Control-Allow-Credentials' 'true';
            add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
            add_header 'Access-Control-Allow-Headers' 'DNT,X-CustomHeader,Keep-Alive,User-Agent,X-RequWith,If-Modified-Since,Cache-Control,Content-Type';
          }
        }
      }